<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Type Ahead ğŸ‘€</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <form class="search-form">
    <input type="text" class="search" placeholder="City or State">
    <ul class="suggestions">
      <li>Filter for a city</li>
      <li>or a state</li>
    </ul>
  </form>
<script>

  // (1) å–å¾—è³‡æ–™
  const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';

  let locationData = [];
  console.log(locationData);

  fetch(endpoint)
    .then(blob => blob.json())
    .then(data => locationData.push(...data));

  // (2) inputå…ƒç´ ç›£è½äº‹ä»¶
  document.querySelector('input').addEventListener('input', displayMatches);
  
  // é¸å–ulå…ƒç´ 
  const suggestions = document.querySelector('.suggestions');

  // è§¸ç™¼çš„å‡½å¼
  function displayMatches(event) {
    // 1. åˆ¤æ–·ç¬¦åˆçš„ç‰©ä»¶ => æ­£è¦è¡¨é”å¼
    // 2. å°‡ç¬¦åˆçš„è³‡æ–™å‘ˆç¾åœ¨é é¢ä¸Š
    // 3. å°‡ç¬¦åˆçš„å­—é«”åŠ ä¸Šé¡è‰²

    // var re = /ab+c/gi;
    // var re = new RegExp('ab+c','gi');

    // å–å¾—<input>å…ƒç´ è§¸ç™¼äº‹ä»¶æ™‚çš„å€¼
    let checkWord = event.target.value;
    // ç¯©é¸ç¬¦åˆçš„ç‰©ä»¶ 
    const matchArray = cities.filter(function(place){
      // è¨­å®šæ­£è¦è¡¨é”å¼çš„ç¯©é¸æ¢ä»¶ç‚ºå…¨æ–‡ä»¥åŠä¸åˆ†å¤§å°å¯«
      const regex = new RegExp(checkWord, 'gi');
      return place.city.match(regex) || place.state.match(regex);
    });
    // å°‡éœ€è¦çš„è³‡æ–™è½‰æˆhtmlæ ¼å¼
    const html = matchArray.map(function(place){
      const regex = new RegExp(checkWord, 'gi');
      // å°‡åŒ¹é…çš„å­—å…ƒç¨ç«‹ä¸€å€‹<span>å…ƒç´ ä¸¦åŠ ä¸Šclass
      const cityName = place.city.replace(regex, `<span class="h1">${checkWord}</span>`)
      const stateName = place.state.replace(regex, `<span class="h1">${checkWord}</span>`)
      // è¨­å®šå›å‚³å…ƒç´ çš„è³‡æ–™æ ¼å¼
      return `
        <li>
          <span class="name">${cityName},${stateName}</span>
          <span class="population">${place.population}</span>
        </li>
      `;
    // å°‡é™£åˆ—è½‰ç‚ºå­—ä¸²
    }).join('');
    // å°‡`ul`å®¹å™¨ä¸­çš„HTMLå…§å®¹æ”¹ç‚ºç¬¦åˆçš„è³‡æ–™å…§å®¹
    suggestions.innerHTML = html;
  }

  // // match()
  // var test_a = new RegExp('a','gi');
  // let a = 'abcAbca';
  // console.log(a.match(test_a)); // ['a', 'A', 'a']

  // // search()
  // var test_b = new RegExp('ba','ig');
  // let b = 'abcAbaca';
  // console.log(b.search(test_b));

  // // replace()
  // var test_c = new RegExp('ab', 'ig');
  // let c = 'ababab';
  // console.log(c.replace(test_c, 'cd'));

  // // split()
  // var text_d = new RegExp('bc', 'ig');
  // let d = 'abcdabcdabcd';
  // console.log(d.split(text_d));

</script>
</body>
</html>
